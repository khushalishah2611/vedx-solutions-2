// Prisma schema for VedX Solutions admin platform
// Configured for MySQL deployments with relational models
// that map to the admin panel feature set.

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum AdminRole {
  SUPER_ADMIN
  EDITOR
  ANALYST
}

enum AdminStatus {
  ACTIVE
  SUSPENDED
}

enum PublishStatus {
  DRAFT
  REVIEW
  PUBLISHED
}

enum EmploymentType {
  FULL_TIME
  PART_TIME
  CONTRACT
  INTERN
}

model AdminUser {
  id           Int           @id @default(autoincrement())
  email        String        @unique
  passwordHash String
  name         String
  role         AdminRole     @default(EDITOR)
  status       AdminStatus   @default(ACTIVE)
  sessions     AdminSession[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model AdminSession {
  id        Int       @id @default(autoincrement())
  token     String    @unique
  adminId   Int
  admin     AdminUser @relation(fields: [adminId], references: [id])
  expiresAt DateTime
  createdAt DateTime  @default(now())
}

model NavigationItem {
  id        Int              @id @default(autoincrement())
  label     String
  path      String
  slug      String           @unique
  visible   Boolean          @default(true)
  order     Int              @default(0)
  parentId  Int?
  parent    NavigationItem?  @relation("NavigationHierarchy", fields: [parentId], references: [id])
  children  NavigationItem[] @relation("NavigationHierarchy")
  seo       PageSeo?
}

model PageSeo {
  id              Int              @id @default(autoincrement())
  pageKey         String           @unique
  metaTitle       String
  metaDescription String?
  keywords        String?
  ogImage         String?
  canonicalUrl    String?
  noIndex         Boolean          @default(false)

  navigationId    Int?             @unique   // ðŸ”§ makes this a proper 1-to-1 relation
  navigation      NavigationItem?  @relation(fields: [navigationId], references: [id])

  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
}

model ServiceCategory {
  id          Int       @id @default(autoincrement())
  name        String
  slug        String    @unique
  description String?
  services    Service[]
}

model Service {
  id          Int              @id @default(autoincrement())
  title       String
  slug        String           @unique
  summary     String?
  imageUrl    String?
  tags        Json?
  categoryId  Int?
  category    ServiceCategory? @relation(fields: [categoryId], references: [id])
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
}

model BlogPost {
  id           Int           @id @default(autoincrement())
  title        String
  slug         String        @unique
  summary      String?
  content      String        @db.Text
  coverImage   String?
  author       String?
  status       PublishStatus @default(DRAFT)
  publishedAt  DateTime?
  tags         Json?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model CareerOpening {
  id               Int            @id @default(autoincrement())
  title            String
  slug             String         @unique
  location         String
  department       String
  employmentType   EmploymentType @default(FULL_TIME)
  description      String?        @db.Text
  requirements     Json?
  isRemoteFriendly Boolean        @default(true)
  isOpen           Boolean        @default(true)
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
}

model ContactMessage {
  id        Int       @id @default(autoincrement())
  name      String
  email     String
  subject   String?
  message   String     @db.Text
  status    String     @default("new")
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
}

model ClientFeedback {
  id        Int       @id @default(autoincrement())
  client    String
  role      String?
  quote     String     @db.Text
  highlight String?
  rating    Int?
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
}

model HireCategory {
  id          Int            @id @default(autoincrement())
  name        String
  slug        String         @unique
  description String?
  roles       HireRole[]
}

model HireRole {
  id             Int          @id @default(autoincrement())
  title          String
  slug           String       @unique
  description    String?
  hireCategory   HireCategory @relation(fields: [hireCategoryId], references: [id])
  hireCategoryId Int
}
