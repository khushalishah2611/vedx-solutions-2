generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum AdminRole {
  SUPER_ADMIN
  EDITOR
  ANALYST
}

enum AdminStatus {
  ACTIVE
  SUSPENDED
}

enum PublishStatus {
  DRAFT
  REVIEW
  PUBLISHED
}

enum OtpPurpose {
  PASSWORD_RESET
}

enum EmploymentType {
  FULL_TIME
  PART_TIME
  CONTRACT
  INTERN
}

model AdminUser {
  id           String        @id @map("_id") @default(auto()) @db.ObjectId
  email        String        @unique
  passwordHash String
  name         String
  role         AdminRole     @default(EDITOR)
  status       AdminStatus   @default(ACTIVE)
  sessions     AdminSession[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model AdminSession {
  id        String     @id @map("_id") @default(auto()) @db.ObjectId
  token     String     @unique
  adminId   String     @db.ObjectId
  admin     AdminUser  @relation(fields: [adminId], references: [id])
  expiresAt DateTime
  createdAt DateTime   @default(now())
}

model NavigationItem {
  id        String              @id @map("_id") @default(auto()) @db.ObjectId
  label     String
  path      String
  slug      String              @unique
  visible   Boolean             @default(true)
  order     Int                 @default(0)
  parentId  String?             @db.ObjectId
  parent    NavigationItem?     @relation("NavigationHierarchy", fields: [parentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  children  NavigationItem[]    @relation("NavigationHierarchy")
  seo       PageSeo?
}

model PageSeo {
  id              String           @id @map("_id") @default(auto()) @db.ObjectId
  pageKey         String           @unique
  metaTitle       String
  metaDescription String?
  keywords        String?
  ogImage         String?
  canonicalUrl    String?
  noIndex         Boolean          @default(false)

  navigationId    String?          @unique @db.ObjectId
  navigation      NavigationItem?  @relation(fields: [navigationId], references: [id], onDelete: NoAction, onUpdate: NoAction)

  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
}

model ServiceCategory {
  id          String    @id @map("_id") @default(auto()) @db.ObjectId
  name        String
  slug        String    @unique
  description String?
  services    Service[]
}

model Service {
  id          String           @id @map("_id") @default(auto()) @db.ObjectId
  title       String
  slug        String           @unique
  summary     String?
  imageUrl    String?
  tags        Json?
  categoryId  String?          @db.ObjectId
  category    ServiceCategory? @relation(fields: [categoryId], references: [id])
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
}

model BlogPost {
  id           String        @id @map("_id") @default(auto()) @db.ObjectId
  title        String
  slug         String        @unique
  summary      String?
  content      String
  coverImage   String?
  author       String?
  status       PublishStatus @default(DRAFT)
  publishedAt  DateTime?
  tags         Json?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model CareerOpening {
  id               String         @id @map("_id") @default(auto()) @db.ObjectId
  title            String
  slug             String         @unique
  location         String
  department       String
  employmentType   EmploymentType @default(FULL_TIME)
  description      String?
  requirements     Json?
  isRemoteFriendly Boolean        @default(true)
  isOpen           Boolean        @default(true)
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
}

model ContactMessage {
  id        String   @id @map("_id") @default(auto()) @db.ObjectId
  name      String
  email     String
  subject   String?
  message   String
  status    String   @default("new")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ClientFeedback {
  id        String   @id @map("_id") @default(auto()) @db.ObjectId
  client    String
  role      String?
  quote     String
  highlight String?
  rating    Int?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model HireCategory {
  id          String     @id @map("_id") @default(auto()) @db.ObjectId
  name        String
  slug        String     @unique
  description String?
  roles       HireRole[]
}

model HireRole {
  id             String       @id @map("_id") @default(auto()) @db.ObjectId
  title          String
  slug           String       @unique
  description    String?
  hireCategory   HireCategory @relation(fields: [hireCategoryId], references: [id])
  hireCategoryId String       @db.ObjectId
}

model OtpVerification {
  id          String     @id @map("_id") @default(auto()) @db.ObjectId
  email       String
  codeHash    String
  purpose     OtpPurpose
  expiresAt   DateTime
  verifiedAt  DateTime?
  consumedAt  DateTime?
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  @@index([email, purpose])
}
