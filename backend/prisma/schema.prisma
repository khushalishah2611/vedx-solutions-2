generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

/// ----------------------------------------------------------
/// ENUMS
/// ----------------------------------------------------------
enum BannerType {
  HOME
  ABOUT
  BLOGS
  CONTACT
  CAREER
}

enum AdminRole {
  SUPER_ADMIN
  EDITOR
  ANALYST
}

enum AdminStatus {
  ACTIVE
  SUSPENDED
}

enum PublishStatus {
  DRAFT
  REVIEW
  PUBLISHED
}

enum EmploymentType {
  FULL_TIME
  PART_TIME
  CONTRACT
  INTERN
}

/// ----------------------------------------------------------
/// DASHBOARD BANNER
/// ----------------------------------------------------------
model Banner {
  id        String        @id @map("_id") @default(auto()) @db.ObjectId
  title     String
  type      BannerType
  /// Non-home banners (about/blogs/contact/career) ek image
  imageUrl  String?
  /// Home banner mate multiple images
  images    BannerImage[]

  createdAt DateTime      @default(now())
  updatedAt DateTime      @updatedAt
}

model BannerImage {
  id        String   @id @map("_id") @default(auto()) @db.ObjectId
  bannerId  String   @db.ObjectId
  banner    Banner   @relation(fields: [bannerId], references: [id])

  imageUrl  String
  sortOrder Int      @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

/// ----------------------------------------------------------
/// PROCESS TAB (steps)
/// ----------------------------------------------------------
model ProcessStep {
  id          String   @id @map("_id") @default(auto()) @db.ObjectId
  title       String
  description String?
  imageUrl    String?

  sortOrder   Int      @default(0)
  isActive    Boolean  @default(true)

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

/// ----------------------------------------------------------
/// OUR SERVICES – SLIDERS + SERVICE CARDS
/// ----------------------------------------------------------
/// Slider = hero section (title + description + image)
model ServiceSlider {
  id                String        @id @map("_id") @default(auto()) @db.ObjectId
  sliderTitle       String
  sliderDescription String?
  sliderImageUrl    String?

  services          ServiceCard[]

  isActive          Boolean       @default(true)
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt
}

/// Individual service cards, mapped to a slider
model ServiceCard {
  id           String        @id @map("_id") @default(auto()) @db.ObjectId
  title        String
  /// Optional, future ma use kari shakay
  subtitle     String?
  description  String?
  imageUrl     String?

  sliderId     String        @db.ObjectId
  slider       ServiceSlider @relation(fields: [sliderId], references: [id])

  sortOrder    Int           @default(0)
  isFeatured   Boolean       @default(false)

  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

/// ----------------------------------------------------------
/// INDUSTRIES WE SERVE
/// ----------------------------------------------------------
/// Header (Title + Description) – singleton type section
model IndustriesConfig {
  id          String     @id @map("_id") @default(auto()) @db.ObjectId
  title       String
  description String?

  items       Industry[]

  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

/// List items (Fintech, Healthtech, etc.)
model Industry {
  id          String           @id @map("_id") @default(auto()) @db.ObjectId
  sectionId   String           @db.ObjectId
  section     IndustriesConfig @relation(fields: [sectionId], references: [id])

  title       String
  description String?
  imageUrl    String?

  sortOrder   Int        @default(0)
  isActive    Boolean    @default(true)

  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  /// Optional: avoid exact same title duplicate per section
  @@unique([sectionId, title])
}

/// ----------------------------------------------------------
/// TECH SOLUTIONS FOR ALL BUSINESS TYPES
/// ----------------------------------------------------------
/// Header content
model TechSolutionsConfig {
  id          String         @id @map("_id") @default(auto()) @db.ObjectId
  title       String
  description String?

  solutions   TechSolution[]

  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
}

/// Solutions list (SMB accelerators, Enterprise modernization)
model TechSolution {
  id          String              @id @map("_id") @default(auto()) @db.ObjectId
  sectionId   String              @db.ObjectId
  section     TechSolutionsConfig @relation(fields: [sectionId], references: [id])

  title       String
  description String?

  sortOrder   Int          @default(0)
  isActive    Boolean      @default(true)

  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

/// ----------------------------------------------------------
/// EXPERTISE MODELS
/// ----------------------------------------------------------
model ExpertiseConfig {
  id          String         @id @map("_id") @default(auto()) @db.ObjectId
  title       String
  description String?

  items       ExpertiseItem[]

  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
}

model ExpertiseItem {
  id          String          @id @map("_id") @default(auto()) @db.ObjectId
  sectionId   String          @db.ObjectId
  section     ExpertiseConfig @relation(fields: [sectionId], references: [id])

  title       String
  description String?
  imageUrl    String?

  sortOrder   Int        @default(0)
  isActive    Boolean    @default(true)

  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

/// ----------------------------------------------------------
/// EXISTING MODELS (Admin, Navigation, Services, Blog, Career, etc.)
/// ----------------------------------------------------------

model AdminUser {
  id           String        @id @map("_id") @default(auto()) @db.ObjectId
  email        String        @unique
  passwordHash String
  name         String
  role         AdminRole     @default(EDITOR)
  status       AdminStatus   @default(ACTIVE)
  sessions     AdminSession[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model AdminSession {
  id        String     @id @map("_id") @default(auto()) @db.ObjectId
  token     String     @unique
  adminId   String     @db.ObjectId
  admin     AdminUser  @relation(fields: [adminId], references: [id])
  expiresAt DateTime
  createdAt DateTime   @default(now())
}

model NavigationItem {
  id        String              @id @map("_id") @default(auto()) @db.ObjectId
  label     String
  path      String
  slug      String              @unique
  visible   Boolean             @default(true)
  order     Int                 @default(0)
  parentId  String?             @db.ObjectId
  parent    NavigationItem?     @relation("NavigationHierarchy", fields: [parentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  children  NavigationItem[]    @relation("NavigationHierarchy")
  seo       PageSeo?
}

model PageSeo {
  id              String           @id @map("_id") @default(auto()) @db.ObjectId
  pageKey         String           @unique
  metaTitle       String
  metaDescription String?
  keywords        String?
  ogImage         String?
  canonicalUrl    String?
  noIndex         Boolean          @default(false)

  navigationId    String?          @unique @db.ObjectId
  navigation      NavigationItem?  @relation(fields: [navigationId], references: [id], onDelete: NoAction, onUpdate: NoAction)

  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
}

model ServiceCategory {
  id            String                @id @map("_id") @default(auto()) @db.ObjectId
  name          String
  slug          String                @unique
  description   String?
  createdAt     DateTime?             @default(now())
  updatedAt     DateTime              @updatedAt
  subCategories ServiceSubCategory[]
}

model Service {
  id            String              @id @map("_id") @default(auto()) @db.ObjectId
  title         String
  slug          String              @unique
  summary       String?
  imageUrl      String?
  tags          Json?
  subCategoryId String?             @db.ObjectId
  subCategory   ServiceSubCategory? @relation(fields: [subCategoryId], references: [id])
  createdAt     DateTime            @default(now())
  updatedAt     DateTime            @updatedAt
}

model ServiceSubCategory {
  id           String          @id @map("_id") @default(auto()) @db.ObjectId
  name         String
  slug         String          @unique
  description  String?
  categoryId   String          @db.ObjectId
  category     ServiceCategory @relation(fields: [categoryId], references: [id])
  createdAt    DateTime        @default(now())
  updatedAt    DateTime        @updatedAt
  services     Service[]
}

model BlogPost {
  id           String        @id @map("_id") @default(auto()) @db.ObjectId
  title        String
  slug         String        @unique
  summary      String?
  content      String
  coverImage   String?
  author       String?
  status       PublishStatus @default(DRAFT)
  publishedAt  DateTime?
  tags         Json?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  categoryId   String?       @db.ObjectId
  category     BlogCategory? @relation(fields: [categoryId], references: [id])
}

model BlogCategory {
  id        String     @id @map("_id") @default(auto()) @db.ObjectId
  name      String     @unique
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  posts     BlogPost[]
}

model CareerOpening {
  id               String         @id @map("_id") @default(auto()) @db.ObjectId
  title            String
  slug             String         @unique
  position         String?
  location         String?
  department       String?
  experience       String?
  employmentType   EmploymentType @default(FULL_TIME)
  postedOn         DateTime?      @default(now())
  imageUrl         String?
  description      String?
  requirements     Json?
  isRemoteFriendly Boolean        @default(true)
  isOpen           Boolean        @default(true)
  applications     CareerApplication[]
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
}

model CareerApplication {
  id             String         @id @map("_id") @default(auto()) @db.ObjectId
  name           String
  email          String
  contact        String?
  experience     String?
  employmentType EmploymentType @default(FULL_TIME)
  appliedOn      DateTime?      @default(now())
  resumeUrl      String?
  notes          String?
  jobId          String?        @db.ObjectId
  job            CareerOpening? @relation(fields: [jobId], references: [id])
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
}

model ContactMessage {
  id          String   @id @map("_id") @default(auto()) @db.ObjectId
  name        String
  email       String
  phone       String?
  countryCode String?
  contactType String?
  projectType String?
  description String?
  subject     String?
  message     String?
  status      String   @default("New")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model ProjectType {
  id        String   @id @map("_id") @default(auto()) @db.ObjectId
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ClientFeedback {
  id        String   @id @map("_id") @default(auto()) @db.ObjectId
  client    String
  role      String?
  quote     String
  highlight String?
  rating    Int?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

/// NOTE: HireCategory / HireRole already exists for "Hire developers" flows.
/// (Mara pela Int-based HireCategory/HireSubcategory models hata – e hataavi didha.)
model HireCategory {
  id          String     @id @map("_id") @default(auto()) @db.ObjectId
  title       String
  slug        String     @unique
  description String?
  roles       HireRole[]
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

model HireRole {
  id             String       @id @map("_id") @default(auto()) @db.ObjectId
  title          String
  slug           String       @unique
  description    String?
  hireCategoryId String       @db.ObjectId
  hireCategory   HireCategory @relation(fields: [hireCategoryId], references: [id])
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
}

model OtpVerification {
  id          String     @id @map("_id") @default(auto()) @db.ObjectId
  email       String
  code        String
  expiresAt   DateTime
  verifiedAt  DateTime?
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  @@index([email])
}
